# Woodrose Budget App: Architecture Map

## 1. Data Flow & Logic
* **User Entry:** The user interacts with the UI hosted by **Amplify**.
* **API Trigger:** The frontend hits **API Gateway**, which acts as the "door" between the client and the VPC.
* **Backend Logic (Lambda):** API Gateway triggers a **Lambda function**.
    * **Secrets:** Accesses **Secrets Manager** for passwords/keys.
    * **Database:** Connects to **RDS (Postgres)** to store/retrieve transaction data.
    * **External:** Connects to **Plaid API** to collect bank transactions.
    * **Real-time:** Connects to **Firebase Firestore** for real-time dashboard updates.

## 2. Network Topology (VPC)
* **Private Subnets:** Host the Lambda functions and Database (RDS).
* **NAT Gateway:** Allows the private Lambdas to "dial out" to Plaid and Firebase without allowing incoming internet traffic.

## 3. Visual Architecture (Mermaid)
```mermaid
graph TD
    %% Use styling to keep it compact %%
    classDef plain fill:#fff,stroke:#333,stroke-width:1px;
    classDef aws fill:#FF9900,stroke:#232F3E,color:white;

    subgraph UserFlow [‘1.Entry’]
        A[User] --> B[Amplify Hosting]
        B --> C[API Gateway]
    end

    subgraph VPC [‘2.VPC_and_Networking’]
        direction TB
        L[NAT Gateway]
        
        subgraph Subnets [Private Subnets]
            D[Lambda Functions]:::aws
            F[“RDS-Aurora-serverless”]:::aws
            
            %% Connections inside the subnet
            C --> D
            D --> F
            D --> E[Secrets Manager]
        end

        %% Connections exiting the subnet via NAT
        D --> L
    end

    subgraph External [‘3.External Services’]
        G[Plaid API]
        H[Firebase Firestore]
        
        %% NAT connections to external
        L --> G
        L --> H
    end
    
    I[EventBridge Scheduler] --> D

    %% Styling
    class D,F,C,L aws